<div class="card container-dentro-sala">
  <div class="card-header header-dentro-sala">
    <h4>Sala</h4> <p>  {{sala.usernameDono}}/<b style="font-size: 1.2em">{{sala.nome}}</b></p>
  </div>
  <div class="card-header participantes-dentro-sala">

    <h5>Participantes ({{sala.usernameParticipantes.length + 1}}/{{sala.qtdCapacidade}}):</h5>
    <ul>
      <li>{{sala.usernameDono}} (dono)</li>
      @for (u of sala.usernameParticipantes; track $index) {
<li>
  <div class="d-flex flex-row align-items-center gap-3 w-100">
    <div>{{u}}</div>
    @if (username==sala.usernameDono){
      <button class="btn btn-sm btn-danger btn-remover-participante" style="font-size:14px; padding:0.15rem 0.25rem; line-height:1;" (click)="abrirModalRemoverParticipante(u)">x</button>
    }
  </div>
</li>
      }
    </ul>
  </div>
  <div class="card-body">

    @if (stompClient.connected) {
      <div class="game-section">
        @if (sala.categoria == 'tictactoe') {
          <div>
            <h2>Jogo da velha</h2>

            <div class="card categoria">
              <app-tictactoe [topic]="topic" [app]="app" [stompClient]="stompClient" [jogadorDono]="sala.usernameDono" [jogadorOponente]="sala.usernameParticipantes[0]" />
            </div>
          </div>
            }
        @else if (sala.categoria == 'jokenpo') {
          <div>
            <h2>Jo-Ken-PÃ´</h2>
            <div class="card categoria">
              <app-jokenpo [topic]="topic" [app]="app" [stompClient]="stompClient" [jogadorDono]="sala.usernameDono" [jogadorOponente]="sala.usernameParticipantes[0]"/>
            </div>
          </div>
            }
        @else if(sala.categoria == 'whoistheimpostor') {
          <div>
            <h2>Quem Ã© o impostor? ðŸ¤”</h2>
            <div class="card categoria">
              <app-who-is-the-impostor [topic]="topic" [app]="app" [stompClient]="stompClient" [jogadorDono]="sala.usernameDono" [outrosJogadores]="sala.usernameParticipantes"/>
            </div>
          </div>
        }
        <div>
          <h2>Chat</h2>
          <div class="card categoria">
            <app-chat [topic]="topic" [app]="app" [stompClient]="stompClient" />
          </div>
        </div>
      </div>
    }
  </div>
  <div class="card-footer sair-dentro-sala">
  @if (sala.usernameDono == username) {
      <button class="btn btn-danger" (click)="abrirModal()">Deletar sala</button>
  }@else{
    <button class="btn btn-warning" (click)="abrirModal()">Sair da sala</button>
  }
</div>
  <div *ngIf="isModalOpen" class="modal-overlay" (click)="fecharModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      @if (sala.usernameDono == username){
        <h2>Deletar sala</h2>
        <p>Tem certeza que deseja deletar a sala?</p>
      }@else{
        <h2>Sair da sala</h2>
        <p>Tem certeza que deseja sair da sala?</p>
      }
      <div class="modal-opcoes">
      @if (sala.usernameDono == username){
        <button class="btn btn-danger" (click)="deletarSala()">Deletar</button>
      } @else {
        <button class="btn btn-warning" (click)="sairSala()">Sair</button>
      }
      <button class="btn btn-secondary" (click)="fecharModal()">Cancelar</button>
      </div>
    </div>
  </div>
  <div *ngIf="participanteASerRemovido!=null" class="modal-overlay" (click)="fecharModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <h2>Remover participante</h2>
      <p style="margin-top: 15px">Tem certeza que deseja remover o participante <b>{{participanteASerRemovido}}</b> da sala?</p>
      <div class="modal-opcoes">
          <button class="btn btn-danger" (click)="removerParticipante()">Remover</button>
        <button class="btn btn-secondary" (click)="fecharModalRemoverParticipante()">Cancelar</button>
      </div>
    </div>
  </div>


</div>
